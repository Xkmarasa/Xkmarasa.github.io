<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin | News</title>
    <style>
        :root { --primary-turquoise:#20B2AA; --dark-turquoise:#008B8B; --light-turquoise:#E0FFFF; --soft-turquoise:#B0E0E6; --pale-turquoise:#F0FFFF; --medium-turquoise:#48CAE4; --deep-turquoise:#007F7F; --white:#FFFFFF; --light-gray:#F8F9FA; --medium-gray:#E9ECEF; --text-gray:#495057; --dark-gray:#212529; --header-bg:linear-gradient(135deg, var(--pale-turquoise) 0%, var(--light-turquoise) 50%, var(--soft-turquoise) 100%); }
        *{margin:0;padding:0;box-sizing:border-box;font-family:'Arial',sans-serif}
        body{background:linear-gradient(180deg,var(--pale-turquoise) 0%,var(--light-turquoise) 100%);color:var(--text-gray);min-height:100vh}
        header{display:flex;align-items:center;justify-content:space-between;padding:15px 20px;background:var(--header-bg)}
        .nav-section{display:flex;gap:12px}
        .nav-item{font-weight:bold;cursor:pointer;color:var(--dark-gray);text-transform:uppercase;font-size:.8em;letter-spacing:1px;padding:8px 15px;text-decoration:none;border-radius:4px;background:var(--white);box-shadow:0 1px 3px rgba(0,0,0,.1)}
        .container{max-width:1000px;margin:24px auto;padding:0 16px}
        h1{color:var(--dark-turquoise);margin-bottom:12px}
        .card{background:var(--white);border:1px solid var(--medium-gray);border-radius:10px;box-shadow:0 3px 18px rgba(0,0,0,.06);padding:16px;margin-bottom:16px}
        .form-row{display:flex;gap:12px;flex-wrap:wrap}
        label{font-weight:bold;color:var(--dark-turquoise);display:block;margin-bottom:6px}
        input,textarea{width:100%;padding:10px;border:2px solid var(--medium-gray);border-radius:6px}
        textarea{min-height:100px}
        .btn{padding:10px 16px;border:none;border-radius:6px;cursor:pointer;font-weight:700}
        .btn-primary{background:linear-gradient(135deg,var(--primary-turquoise) 0%,var(--dark-turquoise) 100%);color:#fff}
        .btn-secondary{background:linear-gradient(135deg,#dfe3e6 0%,#cbd0d6 100%);color:#222}
        .actions{display:flex;gap:10px;justify-content:flex-end;margin-top:12px}
        .list{display:flex;flex-direction:column;gap:12px}
        .item{display:flex;align-items:flex-start;justify-content:space-between;gap:12px;border:1px solid var(--medium-gray);border-radius:8px;padding:10px}
        .item-title{font-weight:700;color:var(--dark-turquoise)}
        .item-meta{font-size:.85em;opacity:.85}
    </style>
</head>
<body>
    <header>
        <div style="font-weight:800;color:var(--dark-turquoise)">News Admin</div>
        <div class="nav-section">
            <a href="home.html" class="nav-item">Home</a>
            <a href="casas.html" class="nav-item">Properties</a>
            <a href="news.html" class="nav-item">News</a>
            <a href="Contact.html" class="nav-item">Contact</a>
        </div>
    </header>

    <div class="container">
        <div class="card">
            <h1>Crear/Editar noticia</h1>
            <div class="form-row">
                <div style="flex:1 1 320px">
                    <label for="newsTitle">Título</label>
                    <input id="newsTitle" placeholder="Título de la noticia">
                </div>
                <div style="flex:1 1 320px">
                    <label for="newsLink">Enlace (opcional)</label>
                    <input id="newsLink" placeholder="https://...">
                </div>
            </div>
            <div class="form-row" style="margin-top:10px">
                <div style="flex:1 1 100%">
                    <label for="newsDesc">Descripción</label>
                    <textarea id="newsDesc" placeholder="Texto de la noticia (admite saltos de línea)"></textarea>
                </div>
            </div>
            <div class="actions">
                <button class="btn btn-secondary" id="clearForm">Limpiar</button>
                <button class="btn btn-primary" id="saveNews">Guardar</button>
            </div>
        </div>

        <div class="card">
            <div style="display:flex;align-items:center;justify-content:space-between">
                <h2 style="color:var(--dark-turquoise);margin:0">Noticias</h2>
                <div style="display:flex;gap:8px">
                    <button class="btn btn-secondary" id="exportBtn">Exportar</button>
                    <button class="btn btn-secondary" id="importBtn">Importar</button>
                    <input type="file" id="importFile" accept="application/json" style="display:none">
                </div>
            </div>
            <div id="newsList" class="list" style="margin-top:12px"></div>
        </div>
    </div>

    <script>
        const KEY = 'mbi_news_items';
        let editingIndex = null;

        function loadNews(){ try{ const raw=localStorage.getItem(KEY); const arr = raw?JSON.parse(raw):[]; return Array.isArray(arr)?arr:[]; }catch(_){ return []; } }
        function saveNewsArray(arr){ localStorage.setItem(KEY, JSON.stringify(arr)); }

        function clearForm(){ document.getElementById('newsTitle').value=''; document.getElementById('newsLink').value=''; document.getElementById('newsDesc').value=''; editingIndex=null; }

        function renderList(){
            const container = document.getElementById('newsList');
            container.innerHTML='';
            const items = loadNews();
            if(!items.length){ container.innerHTML = '<div style="text-align:center;color:#666;padding:16px">Sin noticias</div>'; return; }
            items.forEach((item, idx)=>{
                const el = document.createElement('div');
                el.className='item';
                const dateStr = item.date ? new Date(item.date).toLocaleString() : '';
                el.innerHTML = `
                    <div style="flex:1 1 auto">
                        <div class="item-title">${item.title||'Untitled'}</div>
                        <div class="item-meta">${dateStr}</div>
                        ${item.description?`<div style="margin-top:6px">${(item.description||'').replace(/\n/g,'<br>')}</div>`:''}
                        ${item.link?`<div style="margin-top:6px"><a href="${item.link}" target="_blank" rel="noopener">${item.link}</a></div>`:''}
                    </div>
                    <div style="display:flex;gap:8px">
                        <button class="btn btn-secondary" data-action="edit">Editar</button>
                        <button class="btn btn-secondary" data-action="delete">Eliminar</button>
                    </div>`;
                el.querySelector('[data-action="edit"]').addEventListener('click', ()=>{
                    const items = loadNews();
                    const it = items[idx];
                    document.getElementById('newsTitle').value = it.title||'';
                    document.getElementById('newsLink').value = it.link||'';
                    document.getElementById('newsDesc').value = it.description||'';
                    editingIndex = idx;
                });
                el.querySelector('[data-action="delete"]').addEventListener('click', ()=>{
                    const items = loadNews();
                    items.splice(idx,1);
                    saveNewsArray(items);
                    renderList();
                });
                container.appendChild(el);
            });
        }

        document.getElementById('saveNews').addEventListener('click', ()=>{
            const title = document.getElementById('newsTitle').value.trim();
            const link = document.getElementById('newsLink').value.trim();
            const description = document.getElementById('newsDesc').value.trim();
            if(!title && !description && !link){ return; }
            const items = loadNews();
            const obj = { title, link, description, date: Date.now() };
            if(editingIndex!==null){ items[editingIndex]=obj; } else { items.unshift(obj); }
            saveNewsArray(items); clearForm(); renderList();
        });

        document.getElementById('clearForm').addEventListener('click', clearForm);

        document.getElementById('exportBtn').addEventListener('click', ()=>{
            const dataStr = JSON.stringify(loadNews(), null, 2);
            const blob = new Blob([dataStr], {type:'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url; a.download = 'news-backup.json'; a.click(); URL.revokeObjectURL(url);
        });

        document.getElementById('importBtn').addEventListener('click', ()=> document.getElementById('importFile').click());
        document.getElementById('importFile').addEventListener('change', (e)=>{
            const file = e.target.files && e.target.files[0]; if(!file) return;
            const reader = new FileReader();
            reader.onload = (ev)=>{ try{ const arr = JSON.parse(ev.target.result); if(Array.isArray(arr)){ saveNewsArray(arr); renderList(); } }catch(_){} };
            reader.readAsText(file);
            e.target.value='';
        });

        document.addEventListener('DOMContentLoaded', renderList);
    </script>
</body>
</html>


